# Vulnerabilities 101

## Task 1: Introduction

Cybersecurity is big business in the modern-day world. The hacks that we hear about in newspapers are from exploiting vulnerabilities. In this room, we're going to explain exactly what a vulnerability is, the types of vulnerabilities, and how we can exploit these for success in our penetration testing endeavours.

An enormous part of penetration testing is knowing the skills and resources for whatever situation you face. This room is going to introduce you to some resources that are essential when researching vulnerabilities, specifically:

- What vulnerabilities are  
- Why they're worthy of learning about  
- How vulnerabilities are rated  
- Databases for vulnerability research  
- A showcase of how vulnerability research is used on ACKme's engagement

---

## Task 2: Introduction to Vulnerabilities

A **vulnerability** in cybersecurity is defined as a weakness or flaw in the design, implementation or behaviours of a system or application. An attacker can exploit these weaknesses to gain access to unauthorised information or perform unauthorised actions.

### Example Definition
- **NIST**: “Weakness in an information system, system security procedures, internal controls, or implementation that could be exploited or triggered by a threat source”.

### Main Categories of Vulnerabilities

| Vulnerability            | Description                                                                                      |
|--------------------------|--------------------------------------------------------------------------------------------------|
| Operating System         | Found within OSs and often result in privilege escalation.                                       |
| (Mis)Configuration-based | Caused by incorrectly configured applications or services, e.g., a site exposing user data.      |
| Weak or Default Credentials | Authentication systems using default login info (e.g., username/password: admin/admin).     |
| Application Logic        | Poorly designed app behavior that enables bypassing features like login systems.                 |
| Human-Factor             | Leveraging human behavior, e.g., phishing scams or deceptive emails.                             |

### Questions

**Q1**: An attacker has been able to upgrade the permissions of their system account from "user" to "administrator". What type of vulnerability is this?  
**Answer**: `Operating System`

**Q2**: You manage to bypass a login panel using cookies to authenticate. What type of vulnerability is this?  
**Answer**: `Application Logic`

---

## Task 3: Scoring Vulnerabilities (CVSS & VPR)

### Vulnerability Management

Managing vulnerabilities involves evaluating, categorizing, and prioritizing them. Patching all vulnerabilities is often impossible and inefficient. Hence, we prioritize based on potential risk and impact.

### CVSS – Common Vulnerability Scoring System

Introduced in **2005**, currently at version **3.1**. It evaluates vulnerabilities based on exploitability, existing exploits, and the **CIA triad** (Confidentiality, Integrity, Availability).

#### CVSS Qualitative Severity Rating Scale

| Rating   | Score Range   |
|----------|---------------|
| None     | 0             |
| Low      | 0.1 - 3.9     |
| Medium   | 4.0 - 6.9     |
| High     | 7.0 - 8.9     |
| Critical | 9.0 - 10.0    |

#### CVSS Pros and Cons

| Advantages                                      | Disadvantages                                                                 |
|------------------------------------------------|--------------------------------------------------------------------------------|
| Long-standing and popular                      | Not designed for prioritization                                                |
| Free and recommended by NIST                   | Scores rarely change even with new developments                                |
|                                                | Heavily influenced by exploit availability (only 20% of vulnerabilities have them) |

---

### VPR – Vulnerability Priority Rating

Created by **Tenable**, VPR focuses on **risk** over severity. It is dynamic, updating scores regularly based on real-world factors and usage within an organization.

#### VPR Score Ranges

| Rating   | Score Range   |
|----------|---------------|
| Low      | 0.0 - 3.9     |
| Medium   | 4.0 - 6.9     |
| High     | 7.0 - 8.9     |
| Critical | 9.0 - 10.0    |

#### VPR Pros and Cons

| Advantages                                                   | Disadvantages                                               |
|--------------------------------------------------------------|-------------------------------------------------------------|
| Modern and real-world relevant                               | Not open-source                                             |
| Considers 150+ factors for risk                              | Only available with commercial platforms                    |
| Risk-driven and helps prioritize patching                    | Less emphasis on the CIA triad                              |
| Dynamic scoring system                                       |                                                             |

### Questions

**Q1**: What year was the first iteration of CVSS published?  
**Answer**: `2005`

**Q2**: If you wanted to assess vulnerability based on the risk it poses to an organisation, what framework would you use?  
**Answer**: `VPR`

**Q3**: If you wanted to use a framework that was free and open-source, what framework would that be?  
**Answer**: `CVSS`

---

## Task 4: Vulnerability Databases

### Key Definitions

| Term            | Definition                                                                 |
|-----------------|------------------------------------------------------------------------------|
| Vulnerability   | Weakness/flaw in a system's design, implementation, or behavior             |
| Exploit         | Technique or action that leverages a vulnerability                          |
| Proof of Concept (PoC) | Demonstration or script showing how a vulnerability can be exploited |

### NVD – National Vulnerability Database

- Tracks **CVE** records (Common Vulnerabilities and Exposures)
- Format: `CVE-YEAR-ID` (e.g., CVE-2017-0144 used in WannaCry)
- Useful for browsing vulnerabilities by date or category

### Exploit-DB

- Created by **OffSec**
- Allows searching by software name/version
- Includes **Proof of Concept** code
- Great for real-world exploit research and testing

### Questions

**Q1**: Using NVD, how many CVEs were published in July 2021?  
**Answer**: `1554`

**Q2**: Who is the author of Exploit-DB?  
**Answer**: `OffSec`

---

## Task 5: An Example of Finding a Vulnerability

In this example, we identify a **Version Disclosure** vulnerability which reveals the application version: **Apache Tomcat 9.0.17**

With this information, we:

1. Go to **Exploit-DB**
2. Search for "Apache Tomcat 9.0.17"
3. Find **five applicable exploits**

### Question

**Q1**: What type of vulnerability did we use to find the name and version of the application in this example?  
**Answer**: `Version Disclosure`

---

## Task 6: Showcase – Exploiting ACKme's Application

- First engagement as a Jr. Pentester
- Shadowing a Sr. Pentester
- Deployed a vulnerable site and followed the exploitation steps
- Retrieved the final flag

### Question

**Q1**: Follow along with the showcase of exploiting ACKme's application to the end to retrieve a flag. What is this flag?  
**Answer**: `THM{ACKME_ENGAGEMENT}`

---

## Task 7: Conclusion

Great job! You’ve completed the room. Here's what you've learned:

- What vulnerabilities are
- Why they’re important
- How they’re scored (CVSS and VPR)
- Key databases like **NVD** and **Exploit-DB**
- How to chain vulnerabilities through research for effective exploitation

---
